<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0;"/>
<title>电影选购</title>
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link href="css/tickets.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/phone.js" ></script>
<script type="text/javascript" src="js/menu_x.js"></script>
<script src="js/vue.js" type="text/javascript" charset="utf-8"></script>
<script src="js/axios.min.js" type="text/javascript" charset="utf-8"></script>
<style>
	
	/*给选择添加下划线*/
	.liBorder {
		border-bottom:2px solid red; 	
	}
</style>
</head>
<body>
<div class="whole" id="movie-list">

	<header class="header">
        <a href="javascript:history.back(-1)" class="fa fa-angle-left"></a>
        <span class="names">北京沃美影城常营店</span>
        <span class="collect">
        	<i class="fa fa-star-o"></i>
        </span>
    </header>
    
    <div class="film-length">
    	<!-- <span class="imax">{{name}}</span> -->
    	<span>片长：{{length}}</span>
        
    </div>
    
    <div class="tips">温馨提示：电影开场前30分钟关闭在线售票</div>

     <div data-role="navbar" id="datenav" >
                <ul>
                  <li  class="liBorder" ><a href='#div1' id="aOne" class="linav"><p></p></a></li>
                  <li ><a href='#div2' id="aTwo" class="linav" @click="showSchedule(2)"><p></p></a></li>
                  <li ><a href='#div3' id="aThree" class="linav" @click="showSchedule(3)"><p></p></a></li>
                </ul>
      </div>
    <div class="tickets-list"  v-for="(item,index) in schedule" :key="index">
    	<ul>
        	<li>
            	<div class="ticket-info">
                	<span class="start">{{item.s_starttime}}</span>
                    <span class="styles">{{item.s_dimension}}</span>
                    <span>{{item.s_endtime}}(结束)</span>
                    <span>{{item.room}}</span>
                </div>
                <div class="buy-btn">
                	<span>{{price*item.s_discount}}<b>元</b></span>
                    <a href="choose_seat.html">选座购票</a>
                </div>
            </li>
        </ul>
    </div>
    
</div>

<!-- <script type="text/javascript">
	var menux = new menuX("#J_MenuX",0);
</script> -->

<script type="text/javascript">
$(function(){
	
	$('.collect .fa').click(function(){
		if($(this).hasClass('fa-star-o')){
			$(this).removeClass('fa-star-o').addClass('fa-star');
		}else{
			$(this).removeClass('fa-star').addClass('fa-star-o');
		}
	});
	
	getDate();
	
	$("#datenav ul li").click(function(){
	      $(".liBorder").removeClass("liBorder");
	      $(this).addClass("liBorder");        
	 });
})

  //获取url的参数
var movieid = window.location.href.split("=")[1].split("&")[0];
var name1=window.location.href.split("=")[2].split("&")[0];
var length1=window.location.href.split("=")[3].split("&")[0];
var price1=window.location.href.split("=")[4].split("&")[0];

var vm=new Vue({
	el:"#movie-list",
	data:{
		schedule:[],
		name:name1,
		length:length1,
		price:price1
	},
	created(){
	
		axios({
			url:"/movieSchedule",
			method:"post",
			params:{
				movieid:movieid,
				list:1
			}
		})
		.then(res=>{
			
			this.schedule=res.data;
		})
		.catch(res=>{
			console.info(res)
		});
	},
	methods:{
		showSchedule:function(index){
			axios({
				url:"/movieSchedule",
				method:"post",
				params:{
					movieid:movieid,
					list:index
				}
			})
			.then(res=>{
				
				this.schedule=res.data;
			})
			.catch(res=>{
				console.info(res)
			});
		}
	}
})  

function getDate(){
      var date = new Date();
      var month = date.getMonth() + 1;
  
      var a = [];

      if (month >= 1 && month <= 9) {
            month = "0" + month;
       }

       a[0] = date.getDate();
       if (a[0] >= 0 && a[0]  <= 9) {
               a[0]  = "0" + a[0] ;
            }
        for(var i=1;i<4;i++){3
          a[i] = parseInt(a[i-1])+1;

            if (a[i] >= 0 && a[i]  <= 9) {
               a[i]  = "0" + a[i] ;
            }

        }

      $("#aOne p").text("今天"+month +"-"+ a[0]);
      $("#aTwo p").text(month +"-"+  a[1]);
      $("#aThree p").text(month +"-"+  a[2]);
      $("#aFour p").text(month +"-"+  a[3]);

      $("#aOne p").attr("id",month +"-"+ a[0]);
      $("#aTwo p").attr("id",month +"-"+ a[1]);
      $("#aThree p").attr("id",month +"-"+ a[2]);
      $("#aFour p").attr("id",month +"-"+ a[3]);
      
  }
</script>

</body>
</html>
